version: '3.9'
services: 
  collector:
    build: ./collector
    container_name: collector
    restart: always
    volumes: 
      - data:/var/log/
    ports: 
      - "514:514/tcp"
  transfo:
    build: ./transfo
    container_name: transfo
    restart: always
    depends_on: 
      - collector
      - db
    volumes: 
      - data:/data
  db:
    build: ./db
    container_name: db
    restart: always
    ports:
      - 38080:8080
  web:
    build: ./web
    container_name: web
    depends_on: 
      - transfo
      - db
    command: npm start
    volumes: 
      - ./web/:/web
    ports:
      - 80:3000

volumes: 
  data:
